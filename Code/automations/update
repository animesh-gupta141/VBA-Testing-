Private Function BuildBulletsFromHyphens(ByVal s As String) As String
    Dim parts As Variant, p As Variant, outText As String
    Dim cleaned As String

    ' Clean line breaks and double spaces
    cleaned = Replace(s, vbCrLf, " ")
    cleaned = Replace(cleaned, vbCr, " ")
    cleaned = Replace(cleaned, vbLf, " ")
    cleaned = Trim$(cleaned)

    ' ✅ Split only on a hyphen followed by a space ("- ")
    parts = Split(cleaned, "- ")

    ' Loop through each part — only use as bullet if it’s a full new item
    For Each p In parts
        If Len(Trim$(p)) > 0 Then
            ' Skip leading fragments that come before the first "- "
            If Left$(cleaned, 2) <> "- " And InStr(cleaned, "- ") = 0 Then
                ' no bullets if there were no "- " separators at all
                outText = cleaned
                Exit For
            Else
                outText = outText & Trim$(p) & vbCrLf
            End If
        End If
    Next p

    BuildBulletsFromHyphens = Trim$(outText)
End Function


' === Step: Apply formatting to "Key Management" section ===
Dim keyShape As Object
Set keyShape = sld.Shapes("txt_KeyManagement")

' Set base formatting for the entire text (Arial 10pt, normal)
With keyShape.TextFrame.TextRange.Font
    .Name = "Arial"
    .Size = 10
    .Bold = False
    .Color.RGB = RGB(0, 0, 0)  ' normal text black
End With

' === Highlight and bold date tokens (DD MMM YYYY:) ===
Set regex = CreateObject("VBScript.RegExp")
With regex
    .Global = True
    .IgnoreCase = False
    .Pattern = "(\b\d{1,2}\s[A-Za-z]{3}\s\d{4}:)"
End With

Set tr = keyShape.TextFrame.TextRange
Set matches = regex.Execute(tr.Text)

If matches.Count > 0 Then
    ' Read the color from the first character (keeps your PPT's built-in color)
    Dim dateColor As Long
    dateColor = tr.Characters(1, 1).Font.Color.RGB

    For Each m In matches
        With tr.Characters(m.FirstIndex + 1, Len(m.Value)).Font
            .Bold = True
            .Name = "Arial"
            .Size = 10
            .Color.RGB = dateColor  ' keeps existing PPT color (blue, etc.)
        End With
    Next m
End If
