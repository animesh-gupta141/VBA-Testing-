Private Function BuildBulletsFromHyphens(ByVal s As String) As String
    Dim parts As Variant, p As Variant, outText As String
    Dim cleaned As String

    ' Clean line breaks and double spaces
    cleaned = Replace(s, vbCrLf, " ")
    cleaned = Replace(cleaned, vbCr, " ")
    cleaned = Replace(cleaned, vbLf, " ")
    cleaned = Trim$(cleaned)

    ' ✅ Split only on a hyphen followed by a space ("- ")
    parts = Split(cleaned, "- ")

    ' Loop through each part — only use as bullet if it’s a full new item
    For Each p In parts
        If Len(Trim$(p)) > 0 Then
            ' Skip leading fragments that come before the first "- "
            If Left$(cleaned, 2) <> "- " And InStr(cleaned, "- ") = 0 Then
                ' no bullets if there were no "- " separators at all
                outText = cleaned
                Exit For
            Else
                outText = outText & Trim$(p) & vbCrLf
            End If
        End If
    Next p

    BuildBulletsFromHyphens = Trim$(outText)
End Function

' === Step: Apply formatting to "Key Management" section ===
Dim keyShape As Object
Set keyShape = sld.Shapes("txt_KeyManagement")

' Base formatting for entire text (reset first)
With keyShape.TextFrame.TextRange.Font
    .Name = "Arial"
    .Size = 10
    .Bold = False
    .Color.RGB = RGB(0, 0, 0) ' black by default
End With

' === Detect and format date tokens ===
Set regex = CreateObject("VBScript.RegExp")
With regex
    .Global = True
    .IgnoreCase = False
    .Pattern = "(\b\d{1,2}\s[A-Za-z]{3}\s\d{4}:)"
End With

Set tr = keyShape.TextFrame.TextRange
Set matches = regex.Execute(tr.Text)

If matches.Count > 0 Then
    ' Grab color of first character (your PPT blue)
    Dim dateColor As Long
    dateColor = tr.Characters(1, 1).Font.Color.RGB

    Dim dateText As String, startPos As Long, dateLen As Long, afterLen As Long
    For Each m In matches
        ' Convert date to uppercase
        dateText = UCase$(m.Value)
        startPos = m.FirstIndex + 1
        dateLen = Len(dateText)

        ' Replace original text with uppercase date
        tr.Characters(startPos, Len(m.Value)).Text = dateText

        ' Format the date part: blue + bold
        With tr.Characters(startPos, dateLen).Font
            .Bold = True
            .Name = "Arial"
            .Size = 10
            .Color.RGB = dateColor
        End With

        ' Format text after the colon (till next bullet or line break)
        afterLen = 0
        Do While startPos + dateLen + afterLen <= tr.Length
            If Mid(tr.Text, startPos + dateLen + afterLen, 1) = vbCr Then Exit Do
            afterLen = afterLen + 1
        Loop
        If afterLen > 0 Then
            With tr.Characters(startPos + dateLen, afterLen).Font
                .Bold = False
                .Name = "Arial"
                .Size = 10
                .Color.RGB = RGB(0, 0, 0) ' ensure black
            End With
        End If
    Next m
End If
